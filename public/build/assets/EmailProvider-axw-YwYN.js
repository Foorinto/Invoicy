import{e as P,p as D,c as o,a as x,u as r,h as L,w as k,b as e,s as w,g as p,t as n,f as N,o as a,F as f,r as _,n as V,q as y,C as T,d as c,v as H,O as F,B as E,A as z,k as S,j as $}from"./app-Tt0OmyM3.js";import{_ as I}from"./AppLayout-CnwwZfeQ.js";import{u as R}from"./useTranslations-C1KUhNmC.js";import"./ApplicationLogo-DpNmaR2J.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-BGjOzZvg.js";const G={class:"text-xl font-semibold text-gray-900 dark:text-white"},J={class:"mb-6 border-b border-gray-200 dark:border-gray-700"},K={class:"flex space-x-8","aria-label":"Settings tabs"},Q={class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800"},W={class:"px-6 py-4 space-y-4"},X=["onClick"],Y={class:"flex items-center h-5"},Z=["id","value"],ee={class:"ml-3"},te=["for"],re={key:0,class:"ml-2 inline-flex items-center rounded-full bg-green-100 px-2 py-0.5 text-xs font-medium text-green-800 dark:bg-green-900 dark:text-green-200"},se={class:"text-sm text-gray-500 dark:text-gray-400"},oe={key:0,class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800"},ae={class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},de={class:"text-lg font-medium text-gray-900 dark:text-white"},ie={class:"px-6 py-4 space-y-4"},ne=["for"],le={key:0,class:"text-red-500"},ue=["id","onUpdate:modelValue"],ce=["value"],ge={key:1,class:"relative mt-1"},me=["id","type","onUpdate:modelValue","required"],pe=["onClick"],ye={key:0,class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},ve={key:1,class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},be=["id","type","onUpdate:modelValue","required"],xe={key:3,class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},ke={key:0,class:"text-sm text-red-600"},he={key:1,class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800"},fe={class:"px-6 py-4 space-y-4"},we={key:2,class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800"},_e={class:"px-6 py-4"},Ce={class:"flex items-center justify-between"},je={class:"flex items-center space-x-3"},Me={key:0,class:"w-6 h-6 text-green-600 dark:text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Ve={key:1,class:"w-6 h-6 text-yellow-600 dark:text-yellow-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Fe={class:"font-medium text-gray-900 dark:text-white"},Ee={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},ze=["disabled"],Se={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24"},Ue={class:"mt-2 text-sm text-gray-500 dark:text-gray-400"},Be={class:"flex justify-end space-x-3"},Oe=["disabled"],qe={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},He={__name:"EmailProvider",props:{settings:Object,providers:Object,smtpFields:Object,brevoFields:Object,postmarkFields:Object,resendFields:Object,userEmail:String},setup(u){const{t:v}=R(),m=u,s=P({provider:m.settings.provider||"faktur",from_address:m.settings.from_address||"",from_name:m.settings.from_name||"",config:{}}),b=S(!1),h=S({}),C=z(()=>{switch(s.provider){case"smtp":return m.smtpFields;case"brevo":return m.brevoFields;case"postmark":return m.postmarkFields;case"resend":return m.resendFields;default:return{}}});D(()=>s.provider,g=>{s.config={};const t=C.value;Object.keys(t).forEach(i=>{t[i].default!==void 0&&(s.config[i]=t[i].default)})},{immediate:!0});const j=z(()=>["smtp","brevo","postmark","resend"].includes(s.provider)),U={faktur:"Envoi via les serveurs de faktur.lu. Aucune configuration requise.",smtp:"Utilisez votre propre serveur SMTP (Gmail, Office 365, OVH, etc.).",brevo:"Service d'email marketing et transactionnel (anciennement Sendinblue).",postmark:"Service d'email transactionnel premium avec excellent taux de délivrabilité.",resend:"API email moderne et simple à configurer."},B=()=>{s.put(route("settings.email.provider.update"),{preserveScroll:!0})},O=()=>{b.value=!0,$.post(route("settings.email.provider.test"),{},{preserveScroll:!0,onFinish:()=>{b.value=!1}})},q=g=>{h.value[g]=!h.value[g]},A=(g,t)=>t.type==="password"?h.value[g]?"text":"password":t.type||"text";return(g,t)=>(a(),o(f,null,[x(r(L),{title:"Configuration Email"}),x(I,null,{header:k(()=>[e("h1",G,n(r(v)("settings")),1)]),default:k(()=>[e("div",J,[e("nav",K,[x(r(w),{href:g.route("settings.business.edit"),class:"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"},{default:k(()=>[p(n(r(v)("business_settings")),1)]),_:1},8,["href"]),x(r(w),{href:g.route("settings.email"),class:"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"},{default:k(()=>[p(n(r(v)("email_settings")),1)]),_:1},8,["href"]),x(r(w),{href:g.route("settings.email.provider"),class:"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm border-indigo-500 text-indigo-600 dark:text-indigo-400"},{default:k(()=>[...t[3]||(t[3]=[p(" Fournisseur Email ",-1)])]),_:1},8,["href"])])]),e("form",{onSubmit:N(B,["prevent"]),class:"space-y-6"},[e("div",Q,[t[4]||(t[4]=e("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},[e("h2",{class:"text-lg font-medium text-gray-900 dark:text-white"},"Provider d'envoi"),e("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Choisissez comment envoyer vos factures par email. ")],-1)),e("div",W,[(a(!0),o(f,null,_(u.providers,(i,d)=>(a(),o("div",{key:d,class:V(["relative flex items-start p-4 border rounded-lg cursor-pointer transition-colors",r(s).provider===d?"border-indigo-500 bg-indigo-50 dark:bg-indigo-900/20 dark:border-indigo-400":"border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500"]),onClick:l=>r(s).provider=d},[e("div",Y,[y(e("input",{id:"provider-"+d,type:"radio",value:d,"onUpdate:modelValue":t[0]||(t[0]=l=>r(s).provider=l),class:"h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500"},null,8,Z),[[T,r(s).provider]])]),e("div",ee,[e("label",{for:"provider-"+d,class:"font-medium text-gray-900 dark:text-white cursor-pointer"},[p(n(i)+" ",1),d==="faktur"?(a(),o("span",re," Recommandé ")):c("",!0)],8,te),e("p",se,n(U[d]),1)])],10,X))),128))])]),j.value?(a(),o("div",oe,[e("div",ae,[e("h2",de," Configuration "+n(u.providers[r(s).provider]),1)]),e("div",ie,[(a(!0),o(f,null,_(C.value,(i,d)=>(a(),o("div",{key:d},[e("label",{for:d,class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[p(n(i.label)+" ",1),i.required?(a(),o("span",le,"*")):c("",!0)],8,ne),i.type==="select"?y((a(),o("select",{key:0,id:d,"onUpdate:modelValue":l=>r(s).config[d]=l,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white"},[(a(!0),o(f,null,_(i.options,(l,M)=>(a(),o("option",{key:M,value:M},n(l),9,ce))),128))],8,ue)),[[H,r(s).config[d]]]):i.type==="password"?(a(),o("div",ge,[y(e("input",{id:d,type:A(d,i),"onUpdate:modelValue":l=>r(s).config[d]=l,required:i.required,class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white pr-10"},null,8,me),[[F,r(s).config[d]]]),e("button",{type:"button",onClick:l=>q(d),class:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-400 hover:text-gray-500"},[h.value[d]?(a(),o("svg",ye,[...t[5]||(t[5]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"},null,-1)])])):(a(),o("svg",ve,[...t[6]||(t[6]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)])]))],8,pe)])):y((a(),o("input",{key:2,id:d,type:i.type||"text","onUpdate:modelValue":l=>r(s).config[d]=l,required:i.required,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white"},null,8,be)),[[F,r(s).config[d]]]),i.help?(a(),o("p",xe,n(i.help),1)):c("",!0)]))),128)),r(s).errors.config?(a(),o("p",ke,n(r(s).errors.config),1)):c("",!0)])])):c("",!0),j.value?(a(),o("div",he,[t[9]||(t[9]=e("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},[e("h2",{class:"text-lg font-medium text-gray-900 dark:text-white"},"Expéditeur"),e("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Personnalisez l'adresse et le nom de l'expéditeur. ")],-1)),e("div",fe,[e("div",null,[t[7]||(t[7]=e("label",{for:"from_address",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Adresse email ",-1)),y(e("input",{id:"from_address",type:"email","onUpdate:modelValue":t[1]||(t[1]=i=>r(s).from_address=i),placeholder:"contact@votreentreprise.lu",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white"},null,512),[[E,r(s).from_address]])]),e("div",null,[t[8]||(t[8]=e("label",{for:"from_name",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Nom de l'expéditeur ",-1)),y(e("input",{id:"from_name",type:"text","onUpdate:modelValue":t[2]||(t[2]=i=>r(s).from_name=i),placeholder:"Votre Entreprise",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white"},null,512),[[E,r(s).from_name]])])])])):c("",!0),u.settings.provider!=="faktur"?(a(),o("div",we,[e("div",_e,[e("div",Ce,[e("div",je,[e("div",{class:V(["flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center",u.settings.provider_verified?"bg-green-100 dark:bg-green-900":"bg-yellow-100 dark:bg-yellow-900"])},[u.settings.provider_verified?(a(),o("svg",Me,[...t[10]||(t[10]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])):(a(),o("svg",Ve,[...t[11]||(t[11]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"},null,-1)])]))],2),e("div",null,[e("p",Fe,n(u.settings.provider_verified?"Configuration vérifiée":"Configuration non vérifiée"),1),u.settings.last_test_at?(a(),o("p",Ee," Dernier test : "+n(u.settings.last_test_at),1)):c("",!0)])]),e("button",{type:"button",onClick:O,disabled:b.value||r(s).processing,class:"inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 disabled:opacity-50 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300"},[b.value?(a(),o("svg",Se,[...t[12]||(t[12]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):c("",!0),p(" "+n(b.value?"Envoi en cours...":"Envoyer un email de test"),1)],8,ze)]),e("p",Ue," Un email de test sera envoyé à "+n(u.userEmail)+". ",1)])])):c("",!0),e("div",Be,[e("button",{type:"submit",disabled:r(s).processing,class:"inline-flex items-center rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 disabled:opacity-50"},[r(s).processing?(a(),o("svg",qe,[...t[13]||(t[13]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):c("",!0),p(" "+n(r(s).processing?r(v)("saving"):r(v)("save")),1)],8,Oe)])],32)]),_:1})],64))}};export{He as default};
